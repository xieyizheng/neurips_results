2024-06-04 17:30:04,458 INFO: 
Version Information: 
	Python: 3.8.19
	PyTorch: 2.2.2+cu121
	TorchVision: 0.17.2+cu121
2024-06-04 17:30:04,460 INFO: 
  backend: dp
  type: DPFM_Model
  num_gpu: 1
  manual_seed: 1234
  non-isometric: False
  partial: True
  default_scale: True
  path:[
    resume_state: experiments/dpfm/neurips_full_full_default_xyz/models/final.pth
    resume: False
    results_root: /storage/user/xiyi/xiyi/DEFM/defm/results/dpfm/neurips_full_full_default_xyz50_
    log: /storage/user/xiyi/xiyi/DEFM/defm/results/dpfm/neurips_full_full_default_xyz50_/log
    visualization: /storage/user/xiyi/xiyi/DEFM/defm/results/dpfm/neurips_full_full_default_xyz50_/visualization
    pcks: /storage/user/xiyi/xiyi/DEFM/defm/results/dpfm/neurips_full_full_default_xyz50_/pcks
    heatmaps: /storage/user/xiyi/xiyi/DEFM/defm/results/dpfm/neurips_full_full_default_xyz50_/heatmaps
  ]
  datasets:[
    test_dataset:[
      name: NeurIPSVal
      type: PairNeurIPSDataset
      default_scale: True
      data_root: ../data/NeurIPS/full_full/test/
      return_evecs: True
      return_faces: True
      num_evecs: 50
      return_corr: True
      return_dist: True
    ]
  ]
  cache_dir: ../data/NeurIPS/full_full/test/diffusion
  networks:[
    dpfm_net:[
      type: DPFMNet
      cfg:[
        fmap:[
          n_fmap: 50
          k_eig: 128
          n_feat: 256
          C_in: 3
          lambda_: 100
          resolvant_gamma: 0.5
          robust: False
        ]
        attention:[
          num_head: 4
          gnn_dim: 128
          ref_n_layers: 1
          cross_sampling_ratio: 1.0
          attention_type: normal
        ]
        overlap:[
          overlap_feat_dim: 32
        ]
      ]
    ]
  ]
  train:[
    optims:[
      feature_extractor:[
        type: Adam
        lr: 0.001
      ]
    ]
    schedulers:[
      feature_extractor:[
        type: none
      ]
    ]
    losses:[
      surfmnet_loss:[
        type: PartialFmapsLoss
        w_bij: 1.0
        w_orth: 1.0
      ]
      align_loss:[
        type: SquaredFrobeniusLoss
        loss_weight: 1.0
      ]
    ]
  ]
  val:[
    save_geo_errors: True
    metrics:[
      geo_error:[
        type: calculate_geodesic_error
      ]
      plot_pck_per_pair:[
        type: plot_pck_multiple
      ]
      plot_pck:[
        type: plot_pck
      ]
    ]
  ]
  name: neurips_full_full_default_xyz
  is_train: False
  dist: False
  rank: 0
  world_size: 1

2024-06-04 17:30:06,547 INFO: Dataset [PairNeurIPSDataset]-[NeurIPSVal] is built.
2024-06-04 17:30:06,548 INFO: Number of test images in NeurIPSVal: 284
2024-06-04 17:30:06,578 INFO: Network [DPFMNet] is created.
2024-06-04 17:30:06,789 INFO: Network: DPFMNet, with parameters: 791,041
2024-06-04 17:30:06,789 INFO: Metric [function] is created.
2024-06-04 17:30:06,790 INFO: Metric [function] is created.
2024-06-04 17:30:06,790 INFO: Metric [function] is created.
2024-06-04 17:30:06,900 INFO: Resuming network: dpfm_net
2024-06-04 17:30:06,901 INFO: Model [DPFM_Model] is created.
2024-06-04 17:30:06,901 INFO: Testing PairNeurIPSDataset...
2024-06-04 17:44:01,501 INFO: Avg time: 0.6053
2024-06-04 17:44:02,906 INFO: Val auc: 0.7190
2024-06-04 17:44:02,906 INFO: Val avg error: 0.0803
2024-06-04 17:44:02,907 INFO: Val avg fmap loss: 13.9169
2024-06-04 17:44:02,907 INFO: Val avg acc loss: 0.0000
2024-06-04 17:44:02,907 INFO: Val avg nce loss: 3.7516
2024-06-04 17:44:02,907 INFO: Val avg iou1: 0.9224
2024-06-04 17:44:02,907 INFO: Val avg iou2: 0.9230

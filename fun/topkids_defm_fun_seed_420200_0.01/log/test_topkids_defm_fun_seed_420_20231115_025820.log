2023-11-15 02:58:20,824 INFO: 
Version Information: 
	Python: 3.8.18
	PyTorch: 2.1.0+cu121
	TorchVision: 0.16.0+cu121
2023-11-15 02:58:20,825 INFO: 
  backend: dp
  datasets:[
    test_dataset:[
      bending_weight: 0.01
      data_root: ../data/TOPKIDS/
      name: Val
      num_evecs: 200
      phase: test
      return_dist: True
      return_elas_evecs: True
      return_evecs: True
      return_faces: True
      type: PairTopKidsDataset
    ]
  ]
  manual_seed: 420
  n_elas: 60
  n_lb: 140
  networks:[
    feature_extractor:[
      cache_dir: ../data/TOPKIDS/diffusion
      in_channels: 128
      input_type: wks
      out_channels: 256
      type: DiffusionNet
    ]
    fmap_net:[
      bidirectional: False
      type: RegularizedFMNet
    ]
    mass_fmap_net:[
      bidirectional: True
      type: MassRegularizedFMNet
    ]
    permutation:[
      hard: True
      tau: 0.07
      type: Similarity
    ]
  ]
  non-isometric: False
  num_gpu: 1
  partial: False
  path:[
    resume: False
    resume_state: experiments/fun/topkids_defm_fun_seed_420/models/final.pth
    results_root: /home/guests/yizheng_xie/DEFM/defm/results/fun/topkids_defm_fun_seed_420200_0.01
    log: /home/guests/yizheng_xie/DEFM/defm/results/fun/topkids_defm_fun_seed_420200_0.01/log
    visualization: /home/guests/yizheng_xie/DEFM/defm/results/fun/topkids_defm_fun_seed_420200_0.01/visualization
    pcks: /home/guests/yizheng_xie/DEFM/defm/results/fun/topkids_defm_fun_seed_420200_0.01/pcks
    heatmaps: /home/guests/yizheng_xie/DEFM/defm/results/fun/topkids_defm_fun_seed_420200_0.01/heatmaps
  ]
  refine: 15
  test: True
  train:[
    loss_balance: 1.0
    losses:[
      align_loss:[
        loss_weight: 1.0
        type: SquaredFrobeniusLoss
      ]
      dirichlet_loss:[
        loss_weight: 5.0
        type: DirichletLoss
      ]
      elas_align_loss:[
        loss_weight: 1.0
        type: SquaredFrobeniusLoss
      ]
      masssurfmnet_loss:[
        type: MassSURFMNetLoss
        w_bij: 1.0
        w_lap: 0.0
        w_orth: 1.0
      ]
      surfmnet_loss:[
        type: SURFMNetLoss
        w_bij: 1.0
        w_lap: 0.0
        w_orth: 1.0
      ]
    ]
    optims:[
      feature_extractor:[
        lr: 0.001
        type: Adam
      ]
    ]
    schedulers:[
      feature_extractor:[
        type: none
      ]
    ]
  ]
  type: elas_ortho_FMNetModel
  val:[
    metrics:[
      geo_error:[
        type: calculate_geodesic_error
      ]
      plot_pck:[
        type: plot_pck
      ]
      plot_pck_per_pair:[
        type: plot_pck_multiple
      ]
    ]
    save_geo_errors: True
  ]
  visualize: True
  name: topkids_defm_fun_seed_420
  is_train: False
  dist: False
  rank: 0
  world_size: 1

2023-11-15 02:58:21,053 INFO: Dataset [PairTopKidsDataset]-[Val] is built.
2023-11-15 02:58:21,053 INFO: Number of test images in Val: 25
2023-11-15 02:58:21,058 INFO: Network [DiffusionNet] is created.
2023-11-15 02:58:21,058 INFO: Network [RegularizedFMNet] is created.
2023-11-15 02:58:21,058 INFO: Network [MassRegularizedFMNet] is created.
2023-11-15 02:58:21,058 INFO: Network [Similarity] is created.
2023-11-15 02:58:21,118 INFO: Network: DiffusionNet, with parameters: 510,336
2023-11-15 02:58:21,118 INFO: Network: RegularizedFMNet, with parameters: 0
2023-11-15 02:58:21,118 INFO: Network: MassRegularizedFMNet, with parameters: 0
2023-11-15 02:58:21,118 INFO: Network: Similarity, with parameters: 0
2023-11-15 02:58:21,118 INFO: Metric [function] is created.
2023-11-15 02:58:21,118 INFO: Metric [function] is created.
2023-11-15 02:58:21,118 INFO: Metric [function] is created.
2023-11-15 02:58:21,119 INFO: Network fmap_net has no param to optimize. Ignore it.
2023-11-15 02:58:21,119 INFO: Network mass_fmap_net has no param to optimize. Ignore it.
2023-11-15 02:58:21,119 INFO: Network permutation has no param to optimize. Ignore it.
2023-11-15 02:58:21,119 INFO: Loss [SquaredFrobeniusLoss] is created.
2023-11-15 02:58:21,119 INFO: Loss [DirichletLoss] is created.
2023-11-15 02:58:21,119 INFO: Loss [SquaredFrobeniusLoss] is created.
2023-11-15 02:58:21,119 INFO: Loss [MassSURFMNetLoss] is created.
2023-11-15 02:58:21,119 INFO: Loss [SURFMNetLoss] is created.
2023-11-15 02:58:21,221 INFO: Resuming network: feature_extractor
2023-11-15 02:58:21,222 INFO: Network fmap_net has no param. Ignore it.
2023-11-15 02:58:21,222 INFO: Network mass_fmap_net has no param. Ignore it.
2023-11-15 02:58:21,222 INFO: Network permutation has no param. Ignore it.
2023-11-15 02:58:21,222 INFO: Model [elas_ortho_FMNetModel] is created.
2023-11-15 02:58:21,222 INFO: Testing PairTopKidsDataset...
2023-11-15 03:03:04,724 INFO: Avg time: 9.7257
2023-11-15 03:03:04,855 INFO: Val auc: 0.8628
2023-11-15 03:03:04,855 INFO: Val avg error: 0.0448
